<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FASOWORK â€“ Travail, Logement, Achat/Vente, Services</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f4f6f8; }
    header { background: #0b5e3b; color: white; padding: 20px; text-align: center; }
    .container { padding: 20px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; }
    .card { background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); cursor: pointer; }
    .card:hover { background: #e8f5ef; }
    footer { background: #0b5e3b; color: white; text-align: center; padding: 10px; margin-top: 20px; }
    input, textarea, button, select { width: 100%; max-width: 400px; padding: 10px; margin: 5px 0; }
    button { background: #0b5e3b; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { opacity: 0.9; }
    .publication { background: #fff; padding: 10px; margin: 10px 0; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .filter { margin: 10px 0; display: flex; flex-wrap: wrap; gap: 10px; }
    .filter input { width: auto; flex: 1; }
  </style>
</head>
<body>

<header>
  <h1>FASOWORK</h1>
  <p>Travail â€¢ Logement â€¢ Achat/Vente â€¢ Services</p>
</header>

<div class="container">
  <h2>Que cherchez-vous ?</h2>
  <div class="grid">
    <div class="card" onclick="showSection('travail')">ğŸ’¼<br>Travail</div>
    <div class="card" onclick="showSection('logement')">ğŸ <br>Logement</div>
    <div class="card" onclick="showSection('achat')">ğŸ›’<br>Achat / Vente</div>
    <div class="card" onclick="showSection('services')">ğŸ”§<br>Services</div>
  </div>
</div>

<hr>

<div class="container">
  <h2>ğŸ” Connexion / Inscription</h2>
  <input type="email" id="email" placeholder="Email" />
  <input type="password" id="password" placeholder="Mot de passe (6 caractÃ¨res min)" />
  <button id="signup">CrÃ©er un compte</button>
  <button id="login">Se connecter</button>
  <p id="message"></p>
</div>

<!-- SECTIONS -->
<div class="container" id="travail" style="display:none">
  <h2>ğŸ’¼ Travail</h2>
  <div class="grid">
    <div class="card" onclick="showSection('travail-publier')">ğŸ“¢<br>Publier une offre</div>
    <div class="card" onclick="showSection('travail-chercher')">ğŸ”<br>Chercher un travail</div>
  </div>
</div>

<div class="container" id="travail-publier" style="display:none">
  <button onclick="showSection('travail')">â¬… Retour</button>
  <h2>ğŸ“¢ Publier une offre de travail</h2>
  <input type="text" id="travail-titre" placeholder="Titre du poste">
  <input type="text" id="travail-ville" placeholder="Ville">
  <textarea id="travail-desc" placeholder="Description du travail"></textarea>
  <input type="text" id="travail-whatsapp" placeholder="NumÃ©ro WhatsApp">
  <button onclick="publierTravail()">Publier</button>
  <p id="travail-msg"></p>
</div>

<div class="container" id="travail-chercher" style="display:none">
  <button onclick="showSection('travail')">â¬… Retour</button>
  <h2>ğŸ” Chercher un travail</h2>
  <div class="filter">
    <input type="text" id="travail-ville-filter" placeholder="Filtrer par ville">
    <button onclick="filtrerTravail()">Filtrer</button>
  </div>
  <div id="travail-liste"></div>
</div>

<!-- Logement -->
<div class="container" id="logement" style="display:none">
  <h2>ğŸ  Logement</h2>
  <div class="grid">
    <div class="card" onclick="showSection('logement-publier')">ğŸ“¢<br>Publier un logement</div>
    <div class="card" onclick="showSection('logement-chercher')">ğŸ”<br>Chercher un logement</div>
  </div>
</div>

<div class="container" id="logement-publier" style="display:none">
  <button onclick="showSection('logement')">â¬… Retour</button>
  <h2>ğŸ“¢ Publier un logement</h2>
  <input type="text" id="logement-type" placeholder="Type de logement (chambre, maison)">
  <input type="text" id="logement-ville" placeholder="Quartier / Ville">
  <input type="number" id="logement-prix" placeholder="Prix (FCFA)">
  <textarea id="logement-desc" placeholder="Description du logement"></textarea>
  <input type="text" id="logement-whatsapp" placeholder="NumÃ©ro WhatsApp">
  <button onclick="publierLogement()">Publier</button>
  <p id="logement-msg"></p>
</div>

<div class="container" id="logement-chercher" style="display:none">
  <button onclick="showSection('logement')">â¬… Retour</button>
  <h2>ğŸ” Chercher un logement</h2>
  <div class="filter">
    <input type="text" id="logement-ville-filter" placeholder="Ville">
    <input type="number" id="logement-prix-filter" placeholder="Prix max (FCFA)">
    <button onclick="filtrerLogement()">Filtrer</button>
  </div>
  <div id="logement-liste"></div>
</div>

<!-- Achat / Vente -->
<div class="container" id="achat" style="display:none">
  <h2>ğŸ›’ Achat / Vente</h2>
  <div class="grid">
    <div class="card" onclick="showSection('achat-vendre')">ğŸ“¢<br>Vendre un produit</div>
    <div class="card" onclick="showSection('achat-acheter')">ğŸ”<br>Acheter un produit</div>
  </div>
</div>

<div class="container" id="achat-vendre" style="display:none">
  <button onclick="showSection('achat')">â¬… Retour</button>
  <h2>ğŸ“¢ Vendre un produit</h2>
  <input type="text" id="achat-nom" placeholder="Nom du produit">
  <input type="number" id="achat-prix" placeholder="Prix (FCFA)">
  <input type="text" id="achat-ville" placeholder="Ville">
  <textarea id="achat-desc" placeholder="Description du produit"></textarea>
  <input type="text" id="achat-whatsapp" placeholder="NumÃ©ro WhatsApp">
  <button onclick="publierAchat()">Publier</button>
  <p id="achat-msg"></p>
</div>

<div class="container" id="achat-acheter" style="display:none">
  <button onclick="showSection('achat')">â¬… Retour</button>
  <h2>ğŸ” Acheter un produit</h2>
  <div class="filter">
    <input type="text" id="achat-ville-filter" placeholder="Ville">
    <input type="number" id="achat-prix-filter" placeholder="Prix max (FCFA)">
    <button onclick="filtrerAchat()">Filtrer</button>
  </div>
  <div id="achat-liste"></div>
</div>

<!-- Services -->
<div class="container" id="services" style="display:none">
  <h2>ğŸ”§ Services</h2>
  <div class="grid">
    <div class="card" onclick="showSection('services-proposer')">ğŸ“¢<br>Proposer un service</div>
    <div class="card" onclick="showSection('services-trouver')">ğŸ”<br>Trouver un service</div>
  </div>
</div>

<div class="container" id="services-proposer" style="display:none">
  <button onclick="showSection('services')">â¬… Retour</button>
  <h2>ğŸ“¢ Proposer un service</h2>
  <input type="text" id="service-metier" placeholder="MÃ©tier (plombier, Ã©lectricienâ€¦)">
  <input type="text" id="service-ville" placeholder="Zone / Ville">
  <textarea id="service-desc" placeholder="Description du service"></textarea>
  <input type="text" id="service-whatsapp" placeholder="NumÃ©ro WhatsApp">
  <button onclick="publierService()">Publier</button>
  <p id="service-msg"></p>
</div>

<div class="container" id="services-trouver" style="display:none">
  <button onclick="showSection('services')">â¬… Retour</button>
  <h2>ğŸ” Trouver un service</h2>
  <div class="filter">
    <input type="text" id="service-ville-filter" placeholder="Ville">
    <button onclick="filtrerService()">Filtrer</button>
  </div>
  <div id="service-liste"></div>
</div>

<footer>
  <p>Â© 2025 FASOWORK â€“ Connecter le Faso aux opportunitÃ©s</p>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, addDoc, query, onSnapshot, where } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAtqXB6Zq4fUONHhtCIC7oILfW7KDlmdrY",
  authDomain: "fasowork-2a6a3.firebaseapp.com",
  projectId: "fasowork-2a6a3",
  storageBucket: "fasowork-2a6a3.appspot.com",
  messagingSenderId: "566229002560",
  appId: "1:566229002560:web:4ef30ecf74075ea604b2a5"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const message = document.getElementById("message");

// Auth
document.getElementById("signup").onclick = () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  if(password.length<6){ message.innerText="Le mot de passe doit avoir au moins 6 caractÃ¨res"; return; }
  createUserWithEmailAndPassword(auth,email,password)
    .then(()=>message.innerText="âœ… Compte crÃ©Ã© avec succÃ¨s")
    .catch(err=>message.innerText=err.message);
}
document.getElementById("login").onclick = () => {
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  signInWithEmailAndPassword(auth,email,password)
    .then(()=>message.innerText="âœ… Connexion rÃ©ussie")
    .catch(err=>message.innerText=err.message);
}

// Navigation
window.showSection = id => {
  document.querySelectorAll(".container").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
};

// Publier
async function publier(collectionName, inputs, msgId){
  let data = {};
  for(const id in inputs){ 
    const val = document.getElementById(inputs[id]).value;
    if(!val){ document.getElementById(msgId).innerText="Veuillez remplir tous les champs"; return; }
    data[id] = val;
  }
  await addDoc(collection(db,collectionName),data);
  document.getElementById(msgId).innerText="âœ… PubliÃ©";
  for(const id in inputs) document.getElementById(inputs[id]).value="";
}
function publierTravail(){ publier("travail",{titre:"travail-titre",ville:"travail-ville",desc:"travail-desc",whatsapp:"travail-whatsapp"},"travail-msg"); }
function publierLogement(){ publier("logement",{type:"logement-type",ville:"logement-ville",prix:"logement-prix",desc:"logement-desc",whatsapp:"logement-whatsapp"},"logement-msg"); }
function publierAchat(){ publier("achat",{nom:"achat-nom",prix:"achat-prix",ville:"achat-ville",desc:"achat-desc",whatsapp:"achat-whatsapp"},"achat-msg"); }
function publierService(){ publier("services",{metier:"service-metier",ville:"service-ville",desc:"service-desc",whatsapp:"service-whatsapp"},"service-msg"); }

// Affichage temps rÃ©el avec filtre
function afficherListe(col, elementId, champs, filtres={}){
  const liste = document.getElementById(elementId);
  let q = collection(db,col);
  if(filtres.field && filtres.value) q = query(collection(db,col),where(filtres.field,"==",filtres.value));
  onSnapshot(q, snapshot => {
    liste.innerHTML="";
    snapshot.forEach(doc=>{
      const data = doc.data();
      let html="<div class='publication'>";
      champs.forEach(c=>{ html+=`<p><strong>${c.label}:</strong> ${data[c.key]}</p>`; });
      html+="</div>";
      liste.innerHTML+=html;
    });
  });
}

// Initial load
const loadAll = () => {
  afficherListe("travail","travail-liste",[{key:"titre",label:"Titre"},{key:"ville",label:"Ville"},{key:"desc",label:"Description"},{key:"whatsapp",label:"WhatsApp"}]);
  afficherListe("logement","logement-liste",[{key:"type",label:"Type"},{key:"ville",label:"Ville"},{key:"prix",label:"Prix"},{key:"desc",label:"Description"},{key:"whatsapp",label:"WhatsApp"}]);
  afficherListe("achat","achat-liste",[{key:"nom",label:"Produit"},{key:"prix",label:"Prix"},{key:"ville",label:"Ville"},{key:"desc",label:"Description"},{key:"whatsapp",label:"WhatsApp"}]);
  afficherListe("services","service-liste",[{key:"metier",label:"MÃ©tier"},{key:"ville",label:"Ville"},{key:"desc",label:"Description"},{key:"whatsapp",label:"WhatsApp"}]);
};
loadAll();

// Filtrage simple
function filtrerLogement(){
  const ville = document.getElementById("logement-ville-filter").value.toLowerCase();
  const prix = document.getElementById("logement-prix-filter").value;
  onSnapshot(collection(db,"logement"),snapshot=>{
    const liste = document.getElementById("logement-liste");
    liste.innerHTML="";
    snapshot.forEach(doc=>{
      const d=doc.data();
      if((!ville || d.ville.toLowerCase().includes(ville)) && (!prix || Number(d.prix)<=Number(prix))){
        liste.innerHTML+=`<div class='publication'><p><strong>Type:</strong>${d.type}</p><p><strong>Ville:</strong>${d.ville}</p><p><strong>Prix:</strong>${d.prix}</p><p><strong>Description:</strong>${d.desc}</p><p><strong>WhatsApp:</strong>${d.whatsapp}</p></div>`;
      }
    });
  });
}

function filtrerAchat(){
  const ville = document.getElementById("achat-ville-filter").value.toLowerCase();
  const prix = document.getElementById("achat-prix-filter").value;
  onSnapshot(collection(db,"achat"),snapshot=>{
    const liste = document.getElementById("achat-liste");
    liste.innerHTML="";
    snapshot.forEach(doc=>{
      const d=doc.data();
      if((!ville || d.ville.toLowerCase().includes(ville)) && (!prix || Number(d.prix)<=Number(prix))){
        liste.innerHTML+=`<div class='publication'><p><strong>Produit:</strong>${d.nom}</p><p><strong>Prix:</strong>${d.prix}</p><p><strong>Ville:</strong>${d.ville}</p><p><strong>Description:</strong>${d.desc}</p><p><strong>WhatsApp:</strong>${d.whatsapp}</p></div>`;
      }
    });
  });
}

function filtrerTravail(){
  const ville = document.getElementById("travail-ville-filter").value.toLowerCase();
  onSnapshot(collection(db,"travail"),snapshot=>{
    const liste = document.getElementById("travail-liste");
    liste.innerHTML="";
    snapshot.forEach(doc=>{
      const d=doc.data();
      if(!ville || d.ville.toLowerCase().includes(ville)){
        liste.innerHTML+=`<div class='
